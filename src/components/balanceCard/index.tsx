import React, { useMemo } from "react";
import { Bell, ChevronDown } from "lucide-react";
import "./index.less";
import { bill } from "../../api/getBillsInfo";

interface BalanceCardProps {
  bills: bill[];
}

const BalanceCard: React.FC<BalanceCardProps> = ({ bills }) => {
  const { income, expense } = useMemo(() => {
    let totalIncome = 0;
    let totalExpense = 0;
    bills.forEach((bill) => {
      if (bill.type === 1) {
        totalIncome += bill.amount;
      } else {
        totalExpense += bill.amount;
      }
    });
    return { income: totalIncome, expense: totalExpense };
  }, [bills]);

  return (
    <div className="finance-dashboard">
      <div className="header">
        <div className="user-section">
          <img
            src="https://avatar.iran.liara.run/public"
            alt="User avatar"
            className="avatar"
          />
          <div className="month-selector">
            <ChevronDown size={20} />
            <span>{"October"}</span>
          </div>
        </div>
        <Bell className="notification-icon" size={24} />
      </div>

      <div className="balance-section">
        <span className="balance-label">Account Balance</span>
        <h1 className="balance-amount">¥{income - expense}</h1>
      </div>

      <div className="stats-container">
        <div className="stat-card income">
          <div className="stat-icon income">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 32 32"
              fill="none"
            >
              <path
                d="M8.99992 30L23.0001 30C24.3261 30 25.5978 29.4733 26.5355 28.5355C27.4732 27.5979 28 26.3261 28 25L28 19C28 17.6739 27.4732 16.4021 26.5355 15.4645C25.5978 14.5267 24.3261 14 23.0001 14L8.99992 14C7.67392 14 6.40216 14.5267 5.46448 15.4645C4.5268 16.4021 4 17.6739 4 19L4 25C4 26.3261 4.5268 27.5979 5.46448 28.5355C6.40216 29.4733 7.67392 30 8.99992 30ZM17.5307 18.3045C18.2615 18.6072 18.8862 19.12 19.3259 19.7778C19.7654 20.4355 20.0001 21.2088 20.0001 22C20.0001 23.0608 19.5786 24.0782 18.8284 24.8285C18.0784 25.5786 17.0608 26 16 26C15.209 26 14.4354 25.7654 13.7776 25.3259C13.12 24.8864 12.6071 24.2616 12.3045 23.5307C12.0018 22.7998 11.9224 21.9955 12.077 21.2197C12.2313 20.4437 12.6122 19.731 13.1716 19.1715C13.731 18.6122 14.4436 18.2312 15.2195 18.0768C15.9957 17.9226 16.7999 18.0018 17.5307 18.3045Z"
                fill-rule="evenodd"
                fill="#00A86B"
              ></path>
              <path
                d="M18 22C18 23.1046 17.1046 24 16 24C14.8954 24 14 23.1046 14 22C14 20.8954 14.8954 20 16 20C17.1046 20 18 20.8954 18 22Z"
                fill="#00A86B"
              ></path>
              <path
                d="M10.8108 6.7713C10.8011 7.023 10.8867 7.2691 11.0505 7.4604L15.2902 11.7108C15.3823 11.8007 15.4909 11.8721 15.61 11.9208C15.7334 11.9731 15.8661 12 16 12C16.1341 12 16.2666 11.9731 16.39 11.9208C16.5092 11.8721 16.6179 11.8007 16.71 11.7108L20.9996 7.4604C21.1634 7.2691 21.249 7.023 21.2393 6.7713C21.2296 6.5196 21.1252 6.2809 20.9472 6.1028C20.7691 5.9247 20.5304 5.8203 20.2787 5.8106C20.0271 5.8009 19.781 5.8865 19.5897 6.0503L17 8.5905L17 3.0001C17 2.7348 16.8946 2.4805 16.7071 2.2929C16.5195 2.1054 16.2653 2 16 2C15.7349 2 15.4805 2.1054 15.293 2.2929C15.1054 2.4805 15.0001 2.7348 15.0001 3.0001L15.0001 8.5905L12.4604 6.0503C12.2691 5.8865 12.0231 5.8009 11.7714 5.8106C11.5197 5.8203 11.281 5.9247 11.1029 6.1028C10.9249 6.2809 10.8205 6.5196 10.8108 6.7713Z"
                fill="#00A86B"
              ></path>
            </svg>
          </div>
          <div className="stat-info">
            <span className="stat-label">Income</span>
            <span className="stat-amount">¥{income}</span>
          </div>
        </div>

        <div className="stat-card expenses">
          <div className="stat-icon expense">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 32 32"
              fill="none"
            >
              <path
                d="M8.99992 30L23.0001 30C24.3261 30 25.5978 29.4733 26.5355 28.5355C27.4732 27.5979 28 26.3261 28 25L28 19C28 17.6739 27.4732 16.4021 26.5355 15.4645C25.5978 14.5267 24.3261 14 23.0001 14L8.99992 14C7.67392 14 6.40216 14.5267 5.46448 15.4645C4.5268 16.4021 4 17.6739 4 19L4 25C4 26.3261 4.5268 27.5979 5.46448 28.5355C6.40216 29.4733 7.67392 30 8.99992 30ZM20.0001 22C20.0001 23.0608 19.5786 24.0782 18.8284 24.8285C18.0784 25.5786 17.0608 26 16 26C15.209 26 14.4354 25.7654 13.7776 25.3259C13.12 24.8864 12.6071 24.2616 12.3045 23.5307C12.0018 22.7998 11.9224 21.9955 12.077 21.2197C12.2313 20.4437 12.6122 19.731 13.1716 19.1715C13.731 18.6122 14.4436 18.2312 15.2195 18.0768C15.9957 17.9226 16.7999 18.0018 17.5307 18.3045C18.2615 18.6072 18.8862 19.12 19.3259 19.7778C19.7654 20.4355 20.0001 21.2088 20.0001 22Z"
                fill-rule="evenodd"
                fill="#FD3C4A"
              ></path>
              <path
                d="M18 22C18 23.1046 17.1046 24 16 24C14.8954 24 14 23.1046 14 22C14 20.8954 14.8954 20 16 20C17.1046 20 18 20.8954 18 22Z"
                fill="#FD3C4A"
              ></path>
              <path
                d="M12.4597 7.99831L14.9996 5.40722L14.9996 10.9996C14.9996 11.2649 15.1049 11.5193 15.2924 11.707C15.48 11.8946 15.7344 12 15.9995 12C16.2647 12 16.5191 11.8946 16.7065 11.707C16.8941 11.5193 16.9994 11.2649 16.9994 10.9996L16.9994 5.40722L19.5393 7.99831C19.7255 8.18319 19.9769 8.2873 20.2392 8.2884C20.3792 8.29611 20.5191 8.27418 20.65 8.22423C20.781 8.17418 20.9 8.09731 20.9992 7.99831C21.1854 7.81092 21.29 7.55737 21.29 7.293C21.29 7.02874 21.1854 6.77519 20.9992 6.5877L16.7095 2.2859C16.6166 2.19221 16.5059 2.11773 16.384 2.06698C16.2622 2.01613 16.1316 1.99001 15.9995 1.99001C15.8675 1.99001 15.7368 2.01613 15.6149 2.06698C15.4931 2.11773 15.3825 2.19221 15.2896 2.2859L11.0498 6.53775C10.8563 6.72474 10.7448 6.98109 10.7401 7.25036C10.7355 7.51953 10.8379 7.77959 11.0248 7.97328C11.2118 8.16698 11.468 8.27849 11.7371 8.28319C12.0062 8.2878 12.2662 8.18539 12.4597 7.99831Z"
                fill="#FD3C4A"
              ></path>
            </svg>
          </div>
          <div className="stat-info">
            <span className="stat-label">Expenses</span>
            <span className="stat-amount">¥{expense}</span>
          </div>
        </div>
      </div>
    </div>
  );
};

export default BalanceCard;
